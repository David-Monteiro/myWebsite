<!DOCTYPE html>
<html>
<head>

	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

</head>
<body ng-app="app" ng-controller="PostsCtrl">

	<div class="container">
		<h1>Posts</h1>
		<input ng-model="postBody" class"form-control" />
		<button ng-click="addPost()" class="btn btn-default"> Add Posts </button>
		<ul class="list-group">
			<li class="list-group-item" ng-repeat='post in posts'>
				<strong>{{post.username}}</strong>
				<span>{{post.body}}</span>
			</li>
			<li>asda</li>
		</ul>
	</div>


	<!-- Scripts -->
	<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.4/angular.min.js"></script>
	<script>
		var app = angular.module('app', []);

		app.controller('PostsCtrl', function($scope, $http){

			$scope.addPost = function(){		
		
				if($scope.postBody) {
					var post = {
						username : "david",
						body : $scope.postBody
					};
					console.log("POST: 1st step");
					var res = $http.post('/api/posts', post)
					.then( function(data, status, headers, config) {
						console.log("POST: success");
					}, 
					function(data, status, headers, config) {
						console.error('POST: Error');
					});	
						
					// Making the field empty
					$scope.body=null;
				}
			};

			$http.get('/api/posts')
  			.then(function(posts){ $scope.posts = posts.data; }, 
			function(data, status, headers, config) {
				console.log('GET: Error');
			});


		});

	</script>
</body>
</html>